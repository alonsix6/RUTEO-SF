<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Linky — RESET 2025 San Fernando</title>
<link rel="icon" type="image/png" href="linky-logo.png">

<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Montserrat:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">

<!-- CSS Stylesheets -->
<link rel="stylesheet" href="css/variables.css?v=3.5">
<link rel="stylesheet" href="css/themes.css?v=3.5">
<link rel="stylesheet" href="css/layout.css?v=3.5">
<link rel="stylesheet" href="css/navigation.css?v=3.5">
<link rel="stylesheet" href="css/forms.css?v=3.5">
<link rel="stylesheet" href="css/cards.css?v=3.5">
<link rel="stylesheet" href="css/history.css?v=3.5">
<link rel="stylesheet" href="css/modals.css?v=3.5">
<link rel="stylesheet" href="css/config.css?v=3.5">
<link rel="stylesheet" href="css/utilities.css?v=3.5">
<link rel="stylesheet" href="css/responsive.css?v=3.5">

<!-- Lucide Icons -->
<script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>
<style>
  .icon {
    width: 1em;
    height: 1em;
    vertical-align: -0.125em;
    display: inline-block;
  }
  .icon-sm { width: 0.875em; height: 0.875em; }
  .icon-lg { width: 1.25em; height: 1.25em; }
  .btn .icon, .config-btn .icon, .theme-toggle .icon { margin-right: 0.35em; }
  .theme-option .icon { margin-right: 0.5em; }
  .card-title .icon { margin-right: 0.4em; }
  .config-tab-btn .icon { margin-right: 0.35em; }
  .config-section-title .icon { margin-right: 0.4em; }
  .config-form-title .icon { margin-right: 0.35em; }
  .config-preview-title .icon { margin-right: 0.35em; }
  .config-form-btn .icon { margin-right: 0.3em; }
  .modal-section h3 .icon { margin-right: 0.4em; }
  .tip-box .icon, .warning-box .icon { margin-right: 0.3em; }
  .help-btn .icon { width: 1.2em; height: 1.2em; }
</style>
</head>

<body>

<!-- ============================================
     HTML SECTION 1: CONTAINER Y HEADER
     ============================================ -->

<div class="container">

  <!-- --- Header Principal --- -->
  <div class="header">
    <h1>Linky</h1>
    <p>RESET — San Fernando</p>
  </div>

  <!-- ============================================
       HTML SECTION 2: NAVEGACION TOP HEADER
       ============================================ -->

  <!-- --- Top Navigation Header --- -->
  <nav class="top-nav">
    <!-- Config Button con Texto "Ajustes" -->
    <button class="config-btn" onclick="openConfigModal()" title="Configuración">
      <i data-lucide="settings" class="icon"></i>
      <span>Ajustes</span>
    </button>

    <!-- Theme Toggle Button (Dropdown) -->
    <div style="position: relative;">
      <button class="theme-toggle" onclick="toggleThemeMenu()" title="Cambiar tema" id="themeToggle">
        <i data-lucide="palette" class="icon"></i>
        <span>Temas</span>
      </button>

      <!-- Theme Menu Dropdown -->
      <div id="themeMenu" class="theme-menu hidden">
        <div class="theme-option" onclick="changeTheme('dark')" data-theme="dark">
          <i data-lucide="moon" class="icon"></i> <span class="theme-text">Oscuro</span>
        </div>
        <div class="theme-option" onclick="changeTheme('light')" data-theme="light">
          <i data-lucide="sun" class="icon"></i> <span class="theme-text">Claro</span>
        </div>
        <div class="theme-option" onclick="changeTheme('ocean')" data-theme="ocean">
          <i data-lucide="waves" class="icon"></i> <span class="theme-text">Ocean Blue</span>
        </div>
        <div class="theme-option" onclick="changeTheme('forest')" data-theme="forest">
          <i data-lucide="leaf" class="icon"></i> <span class="theme-text">Forest Green</span>
        </div>
        <div class="theme-option" onclick="changeTheme('pink')" data-theme="pink">
          <i data-lucide="heart" class="icon"></i> <span class="theme-text">Pink</span>
        </div>
      </div>
    </div>
  </nav>

  <!-- ============================================
       HTML SECTION 3: FORMULARIO PRINCIPAL
       ============================================ -->

  <div class="form-container">
    <div class="card">
      <div class="card-title"><i data-lucide="puzzle" class="icon"></i> Crear Nueva UTM</div>

      <!-- --- Form --- -->
      <form id="utmForm" autocomplete="off">

        <!-- URL de Destino -->
        <div class="form-group full">
          <label>URL de Destino *</label>
          <select id="urlDestino" required>
            <option value="">Seleccionar URL...</option>
            <option value="https://delivery.sanfernando.pe/">Delivery – Home</option>
            <option value="https://delivery.sanfernando.pe/categorias/pollo">Delivery – Pollo</option>
            <option value="https://delivery.sanfernando.pe/categorias/embutidos">Delivery – Embutidos</option>
            <option value="https://delivery.sanfernando.pe/categorias/huevo">Delivery – Huevos</option>
            <option value="https://delivery.sanfernando.pe/vales">Delivery – Vales</option>
            <option value="custom">+ URL Personalizada</option>
          </select>
          <input id="urlCustom" class="hidden custom-input" type="url" placeholder="https://example.com"/>
        </div>

        <!-- Division y Plataforma -->
        <div class="form-row">
          <div class="form-group">
            <label>División *</label>
            <select id="division" required>
              <option value="">Seleccionar...</option>
              <option value="brand">Brand</option>
              <option value="ecommerce">Ecommerce</option>
            </select>
          </div>
          <div class="form-group">
            <label>Plataforma *</label>
            <select id="plataforma" required>
              <option value="">Seleccionar...</option>
              <option value="facebook">Meta (FB / IG)</option>
              <option value="google">Google</option>
              <option value="tiktok">TikTok</option>
              <option value="linkedin">LinkedIn</option>
              <option value="twitter">X (Twitter)</option>
              <option value="programatica">Programática</option>
            </select>
          </div>
        </div>

        <!-- Medium y Objetivo -->
        <div class="form-row">
          <div class="form-group">
            <label>Medium (auto)</label>
            <input id="medium" type="text" readonly placeholder="Se genera según plataforma"/>
          </div>
          <div class="form-group">
            <label>Objetivo *</label>
            <select id="objetivo" required>
              <option value="">Seleccionar...</option>
              <option value="trafico">Tráfico</option>
              <option value="conversiones">Conversiones</option>
              <option value="interacciones">Interacciones</option>
              <option value="reproducciones">Reproducciones</option>
              <option value="alcance">Alcance</option>
            </select>
          </div>
        </div>

        <!-- Tipo de Campaña Google (Condicional) -->
        <div id="mediumGoogleGroup" class="form-group hidden">
          <label>Tipo de Campaña Google</label>
          <select id="mediumGoogle">
            <option value="">Seleccionar...</option>
            <option value="paid-search">SEM (paid-search)</option>
            <option value="cross-network">PMAX (cross-network)</option>
            <option value="display">Display</option>
            <option value="video">Video</option>
          </select>
        </div>

        <!-- Tipo de Campaña y Motivo -->
        <div class="form-row">
          <div class="form-group">
            <label>Tipo de Campaña *</label>
            <select id="tipoCampana" required>
              <option value="">Seleccionar...</option>
              <option value="AON">AON (Always On)</option>
              <option value="Cyber">Cyber</option>
              <option value="HUEVOS">HUEVOS</option>
              <option value="NAVIDADB2B">NAVIDADB2B</option>
              <option value="Elaborados">Elaborados</option>
              <option value="account_link" id="accountLinkOption" style="display:none;">account_link</option>
              <option value="custom">+ Personalizada</option>
            </select>
            <input id="campanaCustom" class="hidden custom-input" type="text" placeholder="Nombre de campaña"/>
          </div>
          <div class="form-group">
            <label>Motivo/Creatividad *</label>
            <select id="motivo" required>
              <option value="">Seleccionar...</option>
              <option value="VALES">Vales</option>
              <option value="chorizo">Chorizo</option>
              <option value="hamburguesa">Hamburguesa</option>
              <option value="pollo">Pollo</option>
              <option value="embutidos">Embutidos</option>
              <option value="huevos">Huevos</option>
              <option value="DesayunoSangrecita">Desayuno Sangrecita</option>
              <option value="DescuentoWeb">Descuento Web</option>
              <option value="custom">+ Personalizado</option>
            </select>
            <input id="motivoCustom" class="hidden custom-input" type="text" placeholder="Descripción del motivo"/>
          </div>
        </div>

        <!-- Mes y Año -->
        <div class="form-row">
          <div class="form-group">
            <label>Mes *</label>
            <select id="mes" required>
              <option value="">Seleccionar...</option>
              <option>ENERO</option><option>FEBRERO</option><option>MARZO</option>
              <option>ABRIL</option><option>MAYO</option><option>JUNIO</option>
              <option>JULIO</option><option>AGOSTO</option><option>SETIEMBRE</option>
              <option>OCTUBRE</option><option>NOVIEMBRE</option><option>DICIEMBRE</option>
            </select>
          </div>
          <div class="form-group">
            <label>Año *</label>
            <select id="ano" required></select>
          </div>
        </div>

        <!-- Placement Meta (Condicional) -->
        <div id="placementGroup" class="form-group hidden">
          <label>Placement (Meta)</label>
          <select id="placement">
            <option value="">Seleccionar...</option>
            <option value="META">META (FB + IG)</option>
            <option value="FB">Solo Facebook</option>
            <option value="IG">Solo Instagram</option>
          </select>
        </div>

        <!-- Campos Brand (Condicionales) -->
        <div id="brandFields" class="form-row hidden brand-fields">
          <div class="form-group">
            <label>Código de Pieza *</label>
            <select id="codigoPieza">
              <option value="">Seleccionar...</option>
              <option value="AON">AON</option>
              <option value="NAB2B">NAB2B</option>
              <option value="HUE">HUE</option>
              <option value="Elaborados">Elaborados</option>
              <option value="custom">+ Otro código</option>
            </select>
            <input id="codigoCustom" class="hidden custom-input" type="text" placeholder="Código personalizado"/>
          </div>
          <div class="form-group">
            <label>Número de Pieza *</label>
            <select id="numeroPieza"></select>
          </div>
        </div>

        <!-- Buttons -->
        <div class="btn-group form-actions">
          <button class="btn btn-primary btn-generate" type="submit"><i data-lucide="rocket" class="icon"></i> GENERAR UTM</button>
          <button class="btn btn-secondary" type="button" onclick="resetForm()"><i data-lucide="refresh-cw" class="icon"></i> LIMPIAR</button>
        </div>
      </form>

      <!-- Result Container -->
      <div id="resultContainer" class="hidden">
        <div class="result-box">
          <button class="copy-btn" onclick="copyResult()"><i data-lucide="clipboard-copy" class="icon"></i> Copiar</button>
          <div id="resultText"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- ============================================
       HTML SECTION 4: HISTORIAL DE UTMs
       ============================================ -->

  <div class="history-container">
    <div class="card">
      <div class="card-title"><i data-lucide="bar-chart-2" class="icon"></i> Historial de UTMs</div>

      <!-- Stats Grid -->
      <div class="stat-grid">
        <div class="stat-card">
          <div class="stat-number" id="totalCount">0</div>
          <div class="stat-label">Total</div>
        </div>
        <div class="stat-card">
          <div class="stat-number" id="brandCount">0</div>
          <div class="stat-label">Brand</div>
        </div>
        <div class="stat-card">
          <div class="stat-number" id="ecomCount">0</div>
          <div class="stat-label">Ecom</div>
        </div>
      </div>

      <!-- Export Buttons -->
      <div class="btn-group export-buttons">
        <button class="btn btn-success" onclick="exportCSV()"><i data-lucide="download" class="icon"></i> CSV</button>
        <button class="btn btn-success btn-excel" onclick="exportExcel()"><i data-lucide="file-spreadsheet" class="icon"></i> Excel</button>
        <button class="btn btn-warning" onclick="clearHistory()"><i data-lucide="trash-2" class="icon"></i> Borrar</button>
      </div>

      <!-- UTM List -->
      <div id="utmList" class="utm-list"></div>
    </div>
  </div>

  <!-- ============================================
       HTML SECTION 5: FOOTER
       ============================================ -->

  <div class="footer">Powered by <span class="font-display">RESEARCH</span> | Generador UTM v2.1</div>
</div>

<!-- ============================================
     HTML SECTION 6: BOTON DE AYUDA
     ============================================ -->

<button class="help-btn" onclick="openHelp()" title="Ayuda"><i data-lucide="info" class="icon"></i></button>

<!-- ============================================
     HTML SECTION 6.5: MODAL DE CONFIGURACION
     ============================================ -->

<div id="configModal" class="config-modal-overlay hidden" onclick="closeConfigModal(event)">
  <div class="config-modal-content" onclick="event.stopPropagation()">

    <!-- Config Modal Header -->
    <div class="config-modal-header">
      <h2><i data-lucide="settings" class="icon"></i> Configuración del Generador</h2>
      <div class="config-header-actions">
        <button class="config-restore-btn" onclick="restoreDefaults()" title="Restaurar valores por defecto">
          <i data-lucide="refresh-cw" class="icon"></i> Restaurar
        </button>
        <button class="config-modal-close" onclick="closeConfigModal()"><i data-lucide="x" class="icon"></i></button>
      </div>
    </div>

    <!-- Config Tabs -->
    <div class="config-tabs">
      <button class="config-tab-btn active" onclick="switchConfigTab('urls')" data-tab="urls">
        <i data-lucide="map-pin" class="icon"></i> URLs
      </button>
      <button class="config-tab-btn" onclick="switchConfigTab('campanias')" data-tab="campanias">
        <i data-lucide="target" class="icon"></i> Campañas
      </button>
      <button class="config-tab-btn" onclick="switchConfigTab('motivos')" data-tab="motivos">
        <i data-lucide="palette" class="icon"></i> Motivos
      </button>
      <button class="config-tab-btn" onclick="switchConfigTab('codigos')" data-tab="codigos">
        <i data-lucide="tag" class="icon"></i> Códigos Brand
      </button>
    </div>

    <!-- Config Modal Body -->
    <div class="config-modal-body">

      <!-- TAB: URLs -->
      <div id="configTabUrls" class="config-tab-content">
        <div class="config-section-title"><i data-lucide="map-pin" class="icon"></i> Gestión de URLs Predeterminadas</div>

        <!-- URLs List -->
        <div id="urlsList" class="config-items-list"></div>

        <!-- Add Button -->
        <button class="config-add-btn" onclick="showAddUrlForm()">
          <i data-lucide="plus" class="icon"></i> Agregar Nueva URL
        </button>

        <!-- Add URL Form (Hidden by default) -->
        <div id="addUrlForm" class="config-form hidden">
          <div class="config-form-title"><i data-lucide="plus" class="icon"></i> Agregar Nueva URL</div>
          <div class="config-form-group">
            <label>Etiqueta * (sin espacios ni tildes)</label>
            <input type="text" id="urlLabel" placeholder="Ej: Delivery_Promociones" />
          </div>
          <div class="config-form-group">
            <label>URL *</label>
            <input type="url" id="urlValue" placeholder="https://ejemplo.com" />
          </div>
          <div class="config-form-group">
            <label>Categoría (sin espacios ni tildes)</label>
            <input type="text" id="urlCategory" placeholder="Ej: delivery, corporativo" />
          </div>
          <div class="config-form-actions">
            <button class="config-form-btn save" onclick="saveNewUrl()"><i data-lucide="save" class="icon"></i> Guardar</button>
            <button class="config-form-btn cancel" onclick="cancelAddUrl()"><i data-lucide="x" class="icon"></i> Cancelar</button>
          </div>
        </div>

        <!-- Preview -->
        <div class="config-preview-box">
          <div class="config-preview-title"><i data-lucide="eye" class="icon"></i> Preview</div>
          <div class="config-preview-content">
            Las URLs configuradas aparecerán en el selector "URL de Destino" del formulario principal.
          </div>
        </div>
      </div>

      <!-- TAB: Campañas -->
      <div id="configTabCampanias" class="config-tab-content hidden">
        <div class="config-section-title"><i data-lucide="target" class="icon"></i> Gestión de Tipos de Campaña</div>

        <!-- Campañas List -->
        <div id="campanasList" class="config-items-list"></div>

        <!-- Add Button -->
        <button class="config-add-btn" onclick="showAddCampanaForm()">
          <i data-lucide="plus" class="icon"></i> Agregar Nueva Campaña
        </button>

        <!-- Add Campaña Form (Hidden by default) -->
        <div id="addCampanaForm" class="config-form hidden">
          <div class="config-form-title"><i data-lucide="plus" class="icon"></i> Agregar Nueva Campaña</div>
          <div class="config-form-group">
            <label>Nombre * (sin espacios, tildes ni caracteres especiales)</label>
            <input type="text" id="campanaName" placeholder="Ej: BlackFriday, Verano2025" />
          </div>
          <div class="config-form-group">
            <label>Descripción (sin espacios ni tildes)</label>
            <input type="text" id="campanaDesc" placeholder="Ej: Black_Friday_2025" />
          </div>
          <div class="config-form-group">
            <label>División *</label>
            <select id="campanaDivision">
              <option value="both">Ambas (Brand + Ecommerce)</option>
              <option value="brand">Solo Brand</option>
              <option value="ecommerce">Solo Ecommerce</option>
            </select>
          </div>
          <div class="config-form-actions">
            <button class="config-form-btn save" onclick="saveNewCampana()"><i data-lucide="save" class="icon"></i> Guardar</button>
            <button class="config-form-btn cancel" onclick="cancelAddCampana()"><i data-lucide="x" class="icon"></i> Cancelar</button>
          </div>
        </div>

        <!-- Preview -->
        <div class="config-preview-box">
          <div class="config-preview-title"><i data-lucide="eye" class="icon"></i> Preview UTM</div>
          <div class="config-preview-content">
            <div class="config-preview-label">utm_campaign:</div>
            <div class="config-preview-value" id="previewCampana">brand_conv_[TuCampaña]_OCTUBRE_2025</div>
          </div>
        </div>
      </div>

      <!-- TAB: Motivos -->
      <div id="configTabMotivos" class="config-tab-content hidden">
        <div class="config-section-title"><i data-lucide="palette" class="icon"></i> Gestión de Motivos/Creatividades</div>

        <!-- Motivos List -->
        <div id="motivosList" class="config-items-list"></div>

        <!-- Add Button -->
        <button class="config-add-btn" onclick="showAddMotivoForm()">
          <i data-lucide="plus" class="icon"></i> Agregar Nuevo Motivo
        </button>

        <!-- Add Motivo Form (Hidden by default) -->
        <div id="addMotivoForm" class="config-form hidden">
          <div class="config-form-title"><i data-lucide="plus" class="icon"></i> Agregar Nuevo Motivo</div>
          <div class="config-form-group">
            <label>Nombre * (sin espacios, tildes ni caracteres especiales)</label>
            <input type="text" id="motivoName" placeholder="Ej: descuento_verano, promo_2x1" />
          </div>
          <div class="config-form-group">
            <label>Categoría (sin espacios ni tildes)</label>
            <input type="text" id="motivoCategoria" placeholder="Ej: promocion, producto" />
          </div>
          <div class="config-form-group">
            <label>División *</label>
            <select id="motivoDivision">
              <option value="both">Ambas (Brand + Ecommerce)</option>
              <option value="brand">Solo Brand</option>
              <option value="ecommerce">Solo Ecommerce</option>
            </select>
          </div>
          <div class="config-form-actions">
            <button class="config-form-btn save" onclick="saveNewMotivo()"><i data-lucide="save" class="icon"></i> Guardar</button>
            <button class="config-form-btn cancel" onclick="cancelAddMotivo()"><i data-lucide="x" class="icon"></i> Cancelar</button>
          </div>
        </div>

        <!-- Preview -->
        <div class="config-preview-box">
          <div class="config-preview-title"><i data-lucide="eye" class="icon"></i> Preview UTM</div>
          <div class="config-preview-content">
            <div class="config-preview-label">utm_content:</div>
            <div class="config-preview-value" id="previewMotivo">brand_AON_01_META_[TuMotivo]</div>
          </div>
        </div>
      </div>

      <!-- TAB: Códigos Brand -->
      <div id="configTabCodigos" class="config-tab-content hidden">
        <div class="config-section-title"><i data-lucide="tag" class="icon"></i> Gestión de Códigos de Pieza (Brand)</div>

        <!-- Códigos List -->
        <div id="codigosList" class="config-items-list"></div>

        <!-- Add Button -->
        <button class="config-add-btn" onclick="showAddCodigoForm()">
          <i data-lucide="plus" class="icon"></i> Agregar Nuevo Código
        </button>

        <!-- Add Código Form (Hidden by default) -->
        <div id="addCodigoForm" class="config-form hidden">
          <div class="config-form-title"><i data-lucide="plus" class="icon"></i> Agregar Nuevo Código</div>
          <div class="config-form-group">
            <label>Código * (sin espacios, tildes ni caracteres especiales)</label>
            <input type="text" id="codigoName" placeholder="Ej: VERANO, PROMO2025" />
          </div>
          <div class="config-form-group">
            <label>Descripción (sin espacios ni tildes)</label>
            <input type="text" id="codigoDesc" placeholder="Ej: Campana_Verano_2025" />
          </div>
          <div class="config-form-actions">
            <button class="config-form-btn save" onclick="saveNewCodigo()"><i data-lucide="save" class="icon"></i> Guardar</button>
            <button class="config-form-btn cancel" onclick="cancelAddCodigo()"><i data-lucide="x" class="icon"></i> Cancelar</button>
          </div>
        </div>

        <!-- Preview -->
        <div class="config-preview-box">
          <div class="config-preview-title"><i data-lucide="eye" class="icon"></i> Preview UTM</div>
          <div class="config-preview-content">
            <div class="config-preview-label">utm_content:</div>
            <div class="config-preview-value" id="previewCodigo">brand_[TuCodigo]_01_META_pollo</div>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>

<!-- ============================================
     HTML SECTION 7: MODAL DE AYUDA
     ============================================ -->

<div id="helpModal" class="modal-overlay hidden" onclick="closeHelp(event)">
  <div class="modal-content" onclick="event.stopPropagation()">

    <!-- Modal Header -->
    <div class="modal-header">
      <h2><i data-lucide="book-open" class="icon"></i> Guía Completa del Generador UTM</h2>
      <button class="modal-close" onclick="closeHelp()"><i data-lucide="x" class="icon"></i></button>
    </div>

    <!-- Modal Body -->
    <div class="modal-body">

      <!-- PRESENTACION -->
      <div class="modal-section">
        <h3><i data-lucide="target" class="icon"></i> ¿Qué es el Generador UTM?</h3>
        <p>Esta herramienta te permite crear URLs de rastreo personalizadas (UTM) para todas tus campañas digitales de San Fernando. Con estas URLs podrás identificar exactamente de dónde vienen tus usuarios y qué campañas generan mejores resultados en Google Analytics 4 y Looker Studio.</p>
      </div>

      <!-- IMPORTANCIA -->
      <div class="modal-section">
        <h3><i data-lucide="star" class="icon"></i> ¿Por qué es importante?</h3>
        <ul>
          <li><strong>Medición precisa:</strong> Saber exactamente qué plataforma, campaña o creatividad genera conversiones</li>
          <li><strong>Optimización de presupuesto:</strong> Invertir en lo que realmente funciona</li>
          <li><strong>Reportes claros:</strong> Filtrar datos fácilmente en Analytics y Looker Studio</li>
          <li><strong>Trazabilidad:</strong> Identificar cada pieza gráfica y su rendimiento</li>
        </ul>
      </div>

      <!-- DIFERENCIAS BRAND VS ECOM -->
      <div class="modal-section">
        <h3><i data-lucide="building-2" class="icon"></i> Brand vs Ecommerce</h3>
        <p>Cada división tiene una estrategia diferente de naming según sus objetivos:</p>

        <div class="table-responsive">
          <table>
            <thead>
              <tr>
                <th>Característica</th>
                <th>BRAND</th>
                <th>ECOMMERCE</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Código de Pieza</strong></td>
                <td>Sí (AON, NAB2B, HUE, etc.)</td>
                <td>No</td>
              </tr>
              <tr>
                <td><strong>Número de Pieza</strong></td>
                <td>Sí (01, 02, 14, etc.)</td>
                <td>No</td>
              </tr>
              <tr>
                <td><strong>Enfoque</strong></td>
                <td>Awareness y Branding</td>
                <td>Producto y Conversión directa</td>
              </tr>
              <tr>
                <td><strong>Ejemplo Campaign</strong></td>
                <td><code>brand_alc_AON_OCTUBRE_2025</code></td>
                <td><code>ecommerce_conv_Cyber_OCT_2025</code></td>
              </tr>
              <tr>
                <td><strong>Ejemplo Content</strong></td>
                <td><code>brand_AON_14_IG_VALES</code></td>
                <td><code>ecom_META_chorizo</code></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- PLATAFORMAS -->
      <div class="modal-section">
        <h3><i data-lucide="globe" class="icon"></i> Plataformas Disponibles</h3>
        <div class="platform-grid">
          <div class="platform-tag">Meta (FB/IG)</div>
          <div class="platform-tag">Google</div>
          <div class="platform-tag">TikTok</div>
          <div class="platform-tag">LinkedIn</div>
          <div class="platform-tag">X (Twitter)</div>
          <div class="platform-tag">Programática</div>
        </div>
      </div>

      <!-- OBJETIVOS Y MEDIUM -->
      <div class="modal-section">
        <h3><i data-lucide="target" class="icon"></i> Objetivos y Medium</h3>
        <h4>Objetivos disponibles:</h4>
        <ul>
          <li><strong>Tráfico (trf):</strong> Llevar usuarios al sitio</li>
          <li><strong>Conversiones (conv):</strong> Generar compras o acciones específicas</li>
          <li><strong>Interacciones (int):</strong> Engagement con el contenido</li>
          <li><strong>Reproducciones (rpr):</strong> Video views</li>
          <li><strong>Alcance (alc):</strong> Maximizar impresiones</li>
        </ul>

        <h4>Medium (se genera automáticamente):</h4>
        <ul>
          <li><strong>paid-social:</strong> Para redes sociales (Meta, TikTok, LinkedIn, etc.)</li>
          <li><strong>paid-search:</strong> Para búsquedas en Google (SEM)</li>
          <li><strong>display:</strong> Para banners en Google</li>
          <li><strong>video:</strong> Para campañas de video en Google</li>
          <li><strong>cross-network:</strong> Para Performance Max (PMAX)</li>
        </ul>
      </div>

      <!-- PLACEMENT META -->
      <div class="modal-section">
        <h3><i data-lucide="smartphone" class="icon"></i> Placement en Meta</h3>
        <p>Cuando seleccionas Meta como plataforma, puedes especificar dónde se muestra el anuncio:</p>
        <ul>
          <li><strong>META:</strong> Facebook + Instagram simultáneamente</li>
          <li><strong>FB:</strong> Solo Facebook</li>
          <li><strong>IG:</strong> Solo Instagram</li>
        </ul>
        <div class="tip-box">
          <strong><i data-lucide="lightbulb" class="icon"></i> Tip:</strong> Esto te permite filtrar resultados por red social específica en tus reportes.
        </div>
      </div>

      <!-- GUIA DE FILTRADO EN GA4 -->
      <div class="modal-section">
        <h3><i data-lucide="bar-chart-2" class="icon"></i> Cómo Filtrar en Google Analytics 4</h3>

        <h4>Ruta básica:</h4>
        <div class="code-example">Reports → Acquisition → Traffic Acquisition</div>

        <h4>Filtros por plataforma:</h4>
        <p><strong>Para ver solo Meta (Facebook/Instagram):</strong></p>
        <div class="code-example">
Session source = "facebook"<br>
Session medium = "paid-social"<br>
Session manual ad content CONTAINS "META" | "FB" | "IG"
        </div>

        <p><strong>Para ver solo Google Ads:</strong></p>
        <div class="code-example">
Session source = "google"<br>
Session medium = "paid-search" | "display" | "video"
        </div>

        <p><strong>Para ver solo TikTok:</strong></p>
        <div class="code-example">
Session source = "tiktok"<br>
Session medium = "paid-social"
        </div>

        <h4>Filtros avanzados:</h4>
        <p><strong>Ver campañas de Brand específicas:</strong></p>
        <div class="code-example">
Session campaign CONTAINS "brand"<br>
Session manual ad content CONTAINS "AON" (para Always On)
        </div>

        <p><strong>Ver campañas de Ecommerce:</strong></p>
        <div class="code-example">
Session campaign CONTAINS "ecommerce"<br>
Session manual ad content CONTAINS "VALES" | "pollo" | "embutidos"
        </div>

        <div class="tip-box">
          <strong><i data-lucide="search" class="icon"></i> Consejo Pro:</strong> Usa "Explorations" en GA4 para análisis más profundos. Ve a Explore → Blank → Agrega dimensiones de Session source, Session medium, Session campaign y Session manual ad content.
        </div>
      </div>

      <!-- CONSEJOS EXTRA -->
      <div class="modal-section">
        <h3><i data-lucide="gem" class="icon"></i> Consejos de Filtrado Extra</h3>
        <ul>
          <li><strong>Usa filtros combinados:</strong> Source + Medium + Campaign para precisión máxima</li>
          <li><strong>Crea segmentos:</strong> Guarda tus filtros favoritos como segmentos reutilizables</li>
          <li><strong>Compara períodos:</strong> Usa date ranges para ver evolución temporal</li>
          <li><strong>Secondary dimensions:</strong> Agrega Session manual ad content para ver creatividades</li>
          <li><strong>Custom channel groups:</strong> Agrupa plataformas similares para reportes ejecutivos</li>
        </ul>
      </div>

      <!-- MOTIVO Y CREATIVIDAD -->
      <div class="modal-section">
        <h3><i data-lucide="palette" class="icon"></i> Especificación de Motivo y Creatividad</h3>
        <p>Es crucial ser específico en el campo "Motivo/Creatividad" para identificar exactamente qué pieza gráfica o mensaje está generando resultados:</p>

        <div class="warning-box">
          <strong><i data-lucide="alert-triangle" class="icon"></i> MUY IMPORTANTE - Restricciones de Caracteres:</strong>
          <p style="margin:8px 0 0 0;"><strong>NO uses espacios, tildes, ñ, ni caracteres especiales</strong> en los campos de la UTM. Estos elementos rompen la estructura de la UTM e impiden el tracking posterior en Analytics.</p>

          <h4 style="margin-top:16px;margin-bottom:8px;color:#ef4444;">CARACTERES PROHIBIDOS:</h4>
          <div class="code-example" style="margin-top:8px;">
• Espacios: "pollo parrillero" [X]<br>
• Tildes: "promoción", "válido", "más" [X]<br>
• Eñes: "diseño", "niño" [X]<br>
• Puntuación española: "¿qué?", "¡wow!" [X]<br>
• Acentos sueltos: "´", "`" [X]<br>
• Especiales: "%", "&", "#", "×", "/", "\", "&lt;", "&gt;", etc. [X]
          </div>

          <h4 style="margin-top:16px;margin-bottom:8px;color:#10b981;">USA EN SU LUGAR:</h4>
          <div class="code-example" style="margin-top:8px;background:#f0fdf4;border-color:#86efac;">
[OK] "pollo_parrillero" (guión bajo en lugar de espacio)<br>
[OK] "promocion", "valido", "mas" (sin tildes)<br>
[OK] "diseno", "nino" (reemplaza ñ → n)<br>
[OK] "que", "wow" (sin signos de puntuación)<br>
[OK] "2x1", "descuento20" (números y letras simples)
          </div>

          <p style="margin-top:12px;"><strong><i data-lucide="lightbulb" class="icon"></i> Tip:</strong> El sistema limpia automáticamente estos caracteres mientras escribes, pero es mejor evitarlos desde el inicio.</p>
        </div>

        <div class="tip-box">
          <strong>BUENAS PRÁCTICAS:</strong>
          <ul style="margin-top:8px;">
            <li>Usa guiones bajos (_) en lugar de espacios</li>
            <li>Usa nombres descriptivos y únicos</li>
            <li>Incluye el formato si es relevante: "video_pollo", "carousel_hamburguesa"</li>
            <li>Diferencia versiones: "VALES_v1", "VALES_v2"</li>
            <li>Especifica promociones: "descuento20", "2x1pollo"</li>
            <li>Indica el producto exacto: "pechugaentera", "hotdog"</li>
            <li>Evita tildes: usa "promocion" en vez de "promoción"</li>
          </ul>
        </div>

        <div class="code-example">
[X] MAL: motivo = "¿promoción válida?"<br>
[OK] BIEN: motivo = "promocion_valida"<br><br>
[X] MAL: motivo = "¡oferta 2×1!"<br>
[OK] BIEN: motivo = "oferta_2x1"<br><br>
[X] MAL: motivo = "diseño navideño" (tiene espacio y ñ)<br>
[OK] BIEN: motivo = "diseno_navideno"<br><br>
[X] MAL: motivo = "más_productos" (tiene tilde)<br>
[OK] BIEN: motivo = "mas_productos"
        </div>

        <p><strong>Esto evita:</strong></p>
        <ul>
          <li>Confusión entre campañas similares</li>
          <li>Mezcla de datos de diferentes creatividades</li>
          <li>Imposibilidad de identificar el origen exacto de las conversiones</li>
          <li><strong>Errores de tracking por caracteres no permitidos</strong></li>
        </ul>
      </div>

      <!-- EJEMPLOS PRACTICOS -->
      <div class="modal-section">
        <h3><i data-lucide="briefcase" class="icon"></i> Ejemplos Prácticos</h3>

        <h4>Ejemplo 1: Campaña Brand en Meta</h4>
        <div class="code-example">
URL: https://delivery.sanfernando.pe/categorias/pollo<br>
División: Brand<br>
Plataforma: Meta (FB/IG)<br>
Objetivo: Conversiones<br>
Tipo: AON<br>
Placement: META<br>
Código pieza: AON<br>
Número pieza: 01<br>
Motivo: pollo_parrillero_video<br><br>
<strong>UTM generada:</strong><br>
utm_source=facebook<br>
utm_medium=paid-social<br>
utm_campaign=brand_conv_AON_OCTUBRE_2025<br>
utm_content=brand_AON_01_META_pollo_parrillero_video
        </div>

        <h4>Ejemplo 2: Campaña Ecommerce en Google</h4>
        <div class="code-example">
URL: https://delivery.sanfernando.pe/vales<br>
División: Ecommerce<br>
Plataforma: Google<br>
Medium: paid-search (SEM)<br>
Objetivo: Conversiones<br>
Tipo: account_link<br>
Motivo: VALES_descuento20<br><br>
<strong>UTM generada:</strong><br>
utm_source=google<br>
utm_medium=paid-search<br>
utm_campaign=ecommerce_conv_account_link_OCTUBRE_2025<br>
utm_content=ecom_GOOGLE_VALES_descuento20
        </div>

        <h4>Ejemplo 3: Campaña Ecommerce en Meta</h4>
        <div class="code-example">
URL: https://delivery.sanfernando.pe/categorias/embutidos<br>
División: Ecommerce<br>
Plataforma: Meta (FB/IG)<br>
Placement: FB (Solo Facebook)<br><br>
Objetivo: Conversiones<br>
Tipo: Cyber<br>
Motivo: chorizo_parrillero_2x1<br><br>
<strong>UTM generada:</strong><br>
utm_source=facebook<br>
utm_medium=paid-social<br>
utm_campaign=ecommerce_conv_Cyber_OCTUBRE_2025<br>
utm_content=ecom_FB_chorizo_parrillero_2x1
        </div>

        <h4>Ejemplo 4: Campaña Brand en TikTok</h4>
        <div class="code-example">
URL: https://delivery.sanfernando.pe/<br>
División: Brand<br>
Plataforma: TikTok<br>
Objetivo: Alcance<br>
Tipo: Cyber<br>
Código pieza: HUE<br>
Número pieza: 03<br>
Motivo: huevos_frescos_dance<br><br>
<strong>UTM generada:</strong><br>
utm_source=tiktok<br>
utm_medium=paid-social<br>
utm_campaign=brand_alc_Cyber_OCTUBRE_2025<br>
utm_content=brand_HUE_03_TIKTOK_huevos_frescos_dance
        </div>
      </div>

      <!-- FAQ -->
      <div class="modal-section">
        <h3><i data-lucide="help-circle" class="icon"></i> Preguntas Frecuentes</h3>

        <div class="faq-item">
          <div class="faq-question">¿Por qué Ecommerce no usa códigos de pieza?</div>
          <div class="faq-answer">Es una diferencia en la estrategia de naming. Ecommerce se enfoca en el producto/motivo directamente, mientras que Brand necesita un sistema más estructurado para sus creatividades y campañas de awareness.</div>
        </div>

        <div class="faq-item">
          <div class="faq-question">¿Cómo sé qué código de pieza usar?</div>
          <div class="faq-answer">Los códigos identifican la campaña principal (AON = Always On, NAB2B = Navidad B2B, HUE = Huevos, Elaborados = Elaborados). El número de pieza (01-30) identifica la creatividad específica dentro de esa campaña.</div>
        </div>

        <div class="faq-item">
          <div class="faq-question">¿Qué es "account_link" en Google?</div>
          <div class="faq-answer">Es un tipo de campaña especial que solo aparece para Google. Se usa para elementos compartidos entre distintas campañas de Google Ads que no se limitan a un objetivo específico, como píxeles de conversión, públicos similares, o configuraciones de cuenta que aplican a múltiples campañas simultáneamente.</div>
        </div>

        <div class="faq-item">
          <div class="faq-question">¿Puedo usar la misma UTM en varios lugares?</div>
          <div class="faq-answer">Sí, pero NO es recomendable. Cada UTM debe ser única para cada ubicación/creatividad. Si usas la misma UTM en Facebook e Instagram, no podrás diferenciar de dónde vino el tráfico.</div>
        </div>

        <div class="faq-item">
          <div class="faq-question">¿Los parámetros UTM son case-sensitive?</div>
          <div class="faq-answer">Sí. "VALES", "vales" y "Vales" se consideran diferentes en Analytics. El generador mantiene consistencia, pero ten cuidado si editas manualmente.</div>
        </div>

        <div class="faq-item">
          <div class="faq-question">¿Puedo exportar mi historial?</div>
          <div class="faq-answer">Sí, usa el botón "CSV" en el historial para descargar todas tus UTMs generadas en formato Excel/CSV.</div>
        </div>

        <div class="faq-item">
          <div class="faq-question">¿Qué hago si veo tráfico "Unassigned" en GA4?</div>
          <div class="faq-answer">Significa que GA4 no pudo categorizar automáticamente ese tráfico. Usa el filtro "Session source / medium" para ver de dónde viene y ajusta tu nomenclatura si es necesario.</div>
        </div>
      </div>

      <!-- BUENAS PRACTICAS FINALES -->
      <div class="modal-section">
        <h3><i data-lucide="sparkles" class="icon"></i> Buenas Prácticas Finales</h3>
        <ul>
          <li>Siempre completa todos los campos obligatorios</li>
          <li>Sé consistente con la nomenclatura (mayúsculas/minúsculas)</li>
          <li>Usa nombres descriptivos en "Motivo/Creatividad"</li>
          <li>Guarda tu historial exportando regularmente a CSV</li>
          <li>Prueba tus UTMs antes de lanzar campañas grandes</li>
          <li>Documenta tus convenciones de naming para todo el equipo</li>
          <li>Usa guiones bajos (_) para separar palabras</li>
          <li><strong>No uses espacios (rompen la UTM)</strong></li>
          <li><strong>No uses tildes ni ñ (impiden tracking)</strong></li>
          <li><strong>No uses caracteres especiales: ¿¡´`, %, &, #, ×, /, etc.</strong></li>
          <li>No reutilices UTMs para campañas diferentes</li>
          <li>No agregues UTMs a enlaces internos de tu sitio</li>
        </ul>

        <div class="warning-box" style="margin-top:20px;">
          <strong><i data-lucide="alert-triangle" class="icon"></i> RECUERDA:</strong> Los espacios, tildes, eñes y caracteres especiales españoles (¿¡´`) son la causa #1 de UTMs rotas. Siempre revisa antes de implementar.
        </div>
      </div>

    </div>
  </div>
</div>

<!-- JavaScript - ES Module -->
<script type="module" src="./src/main.js"></script>

<!-- Initialize Lucide Icons -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    lucide.createIcons();
  });
</script>

</body>
</html>
